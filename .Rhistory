gene.data %>% filter(gene == "Dgkz") %>%
lm(value ~ treatment+E_level,.) -> Dgkzlm2
summary(Dgkzlm2) # (b = -4170 ± 1323, n = 29, p < 0.01)
# CB1R --  Cnr1 (Cannabinoid Receptor 1) -- NONE
gene.data %>% filter(gene == "Cnr1") %>%
lm(value ~ treatment*E_level,.) -> Cnr1lm
summary(Cnr1lm)
anova(Cnr1lm)
gene.data %>% filter(gene == "Zif268")
gene.data %>% filter(gene == "Egr1")
# Zif268 (Egr1 or Early Growth Response 1)
gene.data %>% filter(gene == "Egr1") %>%
lm(value ~ treatment*E_level,.) -> Egr1lm
summary(Egr1lm)
anova(Egr1lm)
gene.data %>% filter(gene == "Crh")
# CRH
gene.data %>% filter(gene == "Crh") %>%
lm(value ~ treatment*E_level,.) -> Crh
summary(Crh)
anova(Crh)
# CRHR1
gene.data %>% filter(gene == "Crhr1") %>%
lm(value ~ treatment*E_level,.) -> Crhr1
summary(Crhr1)
anova(Crhr1)
gene.data %>% filter(gene == "Crhr1") %>%
lm(value ~ treatment+E_level,.) -> Crhr1.2
summary(Crhr1.2)
# CRHR2
gene.data %>% filter(gene == "Crhr2") %>%
lm(value ~ treatment*E_level,.) -> Crhr2
summary(Crhr2)
anova(Crhr2)
# PACAP -- Adcyap1
gene.data %>% filter(gene == "Adcyap1") %>%
lm(value ~ treatment*E_level,.) -> Adcyap1
summary(Adcyap1)
anova(Adcyap1)
# PACAP -- Adcyap1 -- NONE
gene.data %>% filter(gene == "Pacap") %>%
lm(value ~ treatment*E_level,.) -> Adcyap1
# PACAP -- Adcyap1 -- NONE
gene.data %>% filter(gene == "Adcyap1") %>%
lm(value ~ treatment*E_level,.) -> Adcyap1
summary(Adcyap1)
anova(Adcyap1)
# STEP
gene.data %>% filter(gene == "Step") %>%
lm(value ~ treatment*E_level,.) -> Step
# STEP -- Ptpn5??
gene.data %>% filter(gene == "Ptpn5") %>%
lm(value ~ treatment*E_level,.) -> Ptpn5
summary(Ptpn5)
anova(Ptpn5)
gene.data %>% filter(gene == "Ptpn5") %>%
lm(value ~ treatment+E_level,.) -> Ptpn5.2
summary(Ptpn5.2)
TREAT %>% filter(symbol == "Ptpn5") # (eFDR  p = 0.56) -- so, very much not significant? One of these that is happenstance.
# UCN
gene.data %>% filter(gene == "Ucn") %>%
lm(value ~ treatment*E_level,.) -> Ucn
# UCN -- NO EXPRESSION
gene.data %>% filter(gene == "Ucn1") %>%
lm(value ~ treatment*E_level,.) -> Ucn
# AVP
gene.data %>% filter(gene == "Avp") %>%
lm(value ~ treatment*E_level,.) -> Avp
summary(Avp)
anova(Avp)
# POMC
gene.data %>% filter(gene == "Pomc") %>%
lm(value ~ treatment*E_level,.) -> Pomc
summary(Pomc)
anova(Pomc)
# NR3C2
gene.data %>% filter(gene == "Nr3c2") %>%
lm(value ~ treatment*E_level,.) -> Nr3c2
summary(Nr3c2)
anova(Nr3c2)
# NR3C1
gene.data %>% filter(gene == "Nr3c1") %>%
lm(value ~ treatment*E_level,.) -> Nr3c1
summary(Nr3c1)
anova(Nr3c1)
# NPY
gene.data %>% filter(gene == "Npy") %>%
lm(value ~ treatment*E_level,.) -> Npy
summary(Npy)
anova(Npy)
# GRP
gene.data %>% filter(gene == "Grp") %>%
lm(value ~ treatment*E_level,.) -> Grp
summary(Grp)
anova(Grp)
gene.data %>% filter(gene == "Grp") %>%
lm(value ~ treatment+E_level,.) -> Grp.2
summary(Grp.2)
OIL <- readRDS("results/Oil_limma_results.RDS")
OPFR <- readRDS("results/OPFR_limma_results.RDS")
OIL %>% filter(symbol == "Grp") # (
View(OIL)
OIL$M_v_low %>% filter(symbol == "Grp") # (
OIL$M_v_high %>% filter(symbol == "Grp") # (
View(OIL)
OPFR$M_v_low %>% filter(symbol == "Grp") # (
OPFr$M_v_high %>% filter(symbol == "Grp") # (
OPFR$M_v_high %>% filter(symbol == "Grp") # (
gene.data %>% filter(gene == "Grp") %>%
lm(value ~ treatment+E_level,.) -> Grp.2
summary(Grp.2) # sex effect: (b = -619 ± 314, n = 29, p = 0.060
View(OIL[["M_v_low"]])
OIL[["M_v_low"]] %>% filter(symbol == "Grp") # (
gene.data %>% filter(gene == "Grp")
OIL[["M_v_low"]] %>% filter(symbol == "Grp") # (
OPFR$low_v_high %>% filter(symbol == "Grp") # (
# FKBP5
gene.data %>% filter(gene == "Fkbp5") %>%
lm(value ~ treatment*E_level,.) -> Fkbp5
summary(Fkbp5)
anova(Fkbp5)
gene.data %>% filter(gene == "Fkbp5") %>%
lm(value ~ treatment+E_level,.) -> Fkbp5.2
summary(Fkbp5.2)
TREAT %>% filter(symbol == "Fkbp5") # (eFDR  p = 0.32) -- so, very much not significant? One of these that is happenstance.
# initial cleaning and checks
library(limma)
library(tidyverse)
library(scales)
library(tidyverse)
library(DESeq2)
library(pheatmap)
library(annotables)
library(ggpubr)
source("functions/geom_boxjitter.R")
rawcounts <- read.csv("rawdata/KT_Counts.csv")
bcx1 <- rawcounts %>% column_to_rownames(.,var = "X")
id <- read.csv("rawdata/kim rnaseq phenodata.csv")
idxx <- id %>% column_to_rownames(.,var = "id")
all(rownames(idxx) == colnames(bcx1)) #check they match
#### count checks
colSums(bcx1[,]) %>%
as_tibble_row() %>%
t() %>%
as.data.frame() %>%
rownames_to_column(var = 'id') %>%
dplyr::rename(genecounts = V1) -> genecounts
genecounts <- genecounts %>%
full_join(id)
#########
genecounts %>%
ggplot(aes(genecounts)) +
geom_histogram(bins = 54,alpha =0.5,color = 'grey') +
theme_classic()
counts <- genecounts %>%
ggplot(aes(id,genecounts))+
geom_bar(stat = 'identity')+
coord_flip()
ggsave("imgs/braincounts_byid.png",counts, height = 5,width= 5, dpi = 150)
# all quite tight -- well processed.
####
counts2 <- genecounts %>%
ggplot(aes(treatment,genecounts, color = treatment))+
geom_boxjitter(outlier.color = NA, jitter.shape = 21,
alpha = 1,
width = 0.5,
jitter.height = 0.02, jitter.width = 0.07, errorbar.draw = TRUE,
position = position_dodge(0.6)) +
theme_classic()+
theme(legend.position = "none")
counts2
ggsave("imgs/braincounts_bytreatment.png",counts2, height = 5,width= 5, dpi = 150)
## WOW -- simply less expression overall in OPFR treated animals????? -- double check in on this later.
counts3 <- genecounts %>%
ggplot(aes(treatment,genecounts, color = sex))+
geom_boxjitter(outlier.color = NA, jitter.shape = 21,
alpha = 1,
width = 0.5,
jitter.height = 0.02, jitter.width = 0.02, errorbar.draw = TRUE,
position = position_dodge(0.8)) +
theme_classic()
counts3
ggsave("imgs/braincounts_bygroupandROI_ham.png",counts3, height = 5,width= 5, dpi = 150)
### OVERALL less expression in OPFR, but more dramatically impacted in Fs than Ms? -- check interaction here.
#### counts~treatment
genecounts %>%
ggplot(aes(treatment,genecounts, fill = treatment))+
stat_compare_means(method = "t.test", size = 6, label.x = 1.5) +
geom_boxjitter(outlier.color = NA, jitter.shape = 21,
alpha = 1,
width = 0.5,
jitter.height = 0.02, jitter.width = 0.02, errorbar.draw = TRUE,
position = position_dodge(0.8)) +
scale_fill_manual(values=c("skyblue", "hotpink")) +
labs(title="Counts~Treatment",x="Group", y = "Gene Counts") +
theme_classic() +
theme(axis.line = element_line(colour = 'black', size = 1),
axis.ticks = element_line(colour = "black", size = 1),
legend.position="none",
axis.text=element_text(size=16),
axis.title=element_text(size=18,face="bold"),
plot.title = element_text(size=24, hjust = 0.4))
t.test(genecounts~treatment, genecounts)
sd(genecounts~treatment, genecounts)
genecounts %>%  filter(treatment == "Oil") %>% sd(genecounts,. )
genecounts %>%  filter(treatment == "Oil") %>% sd(genecounts)
genecounts %>%  filter(treatment == "Oil")
genecounts %>%  filter(treatment == "Oil") %>% sd(genecounts,.)
df %>%
group_by(treatment) %>%
summarise(sd_var1 = sd(genecounts, na.rm=TRUE))
genecounts %>%
group_by(treatment) %>%
summarise(sd_var1 = sd(genecounts, na.rm=TRUE))
t.test(genecounts~treatment, genecounts)
genecounts %>%
group_by(treatment) %>%
summarise(sd_var1 = sd(genecounts, na.rm=TRUE))
cohensD(genecounts~treatment, genecounts)
install.packages("lsr")
library(lsr)
t.test(genecounts~treatment, genecounts)
genecounts %>%
group_by(treatment) %>%
summarise(sd_var1 = sd(genecounts, na.rm=TRUE))
cohensD(genecounts~treatment, genecounts)
View(idxx)
TREATMENT_limma_results1 <- readRDS("results/TREATMENT_limma_results.RDS")
# volcano plot Males
library(limma)
library(edgeR)
library(Mus.musculus)
organism = 'org.Mm.eg.db'
library(organism, character.only = TRUE)
library(biomaRt)
library(AnnotationDbi)
library(pheatmap)
library(annotables)
library(clusterProfiler)
library(enrichplot)
library(organism, character.only = TRUE)
library(DOSE)
library(EnhancedVolcano)
library(tidyverse)
grcm38 # mouse genes
my_logFC_threshold = 0.2
y1a <- readRDS("results/Elevel_M_limma_results.RDS")
dc <- y1a %>% mutate(contrast = "Oil vs. OPFR") %>% mutate(log10 = -log10(P.Value))
dc$diffexpressed <- "NO"
# if log2Foldchange > 0.2 and pvalue < 0.05, set as "UP"
dc$diffexpressed[dc$logFC > 0.2 & dc$P.Value < 0.05] <- "UP"
# if log2Foldchange < -0.2 and pvalue < 0.05, set as "DOWN"
dc$diffexpressed[dc$logFC < -0.2 & dc$P.Value < 0.05] <- "DOWN"
dcx <- dc %>% filter(.,logFC >= .4)%>% filter(P.Value < 0.05)
dcxx <- dc %>% filter(.,logFC <= -.45) %>% filter(P.Value < 0.05)
dcxxx<- dc %>%
filter(logFC >= 0.2 | logFC <= -0.2) %>%
arrange(P.Value) %>%
slice_head(n = 10)
dc$log10 <- ifelse(dc$log10 == Inf, 4,dc$log10)
vp_Elevel_M <- ggplot(data = dc,
aes(x = logFC,
y = log10,
colour=diffexpressed)) +
geom_point(alpha=0.25, size=3.5) +
scale_color_manual(values=c("hotpink", "grey","skyblue"))+
xlim(c(-1.5, 1.5)) +
ylim(0,4)+
geom_vline(xintercept=c(-.2,.2),lty=4,col="black",lwd=0.8) +
#  geom_vline(xintercept=c(-1,1),lty=4,col="black",lwd=0.8) +
geom_hline(yintercept = 1.301,lty=4,col="black",lwd=0.8) +
#  geom_text_repel(data = dcx, aes(x = logFC, y = -log10(P.Value),label = symbol), color = "black",vjust =1, hjust =.45)+
#  geom_text_repel(data = dcxx, aes(x = logFC, y = -log10(P.Value),label = symbol), color = "black", hjust = 1, vjust = -.55)+
geom_text_repel(data = dcxxx, aes(x = logFC, y = -log10(P.Value),label = symbol), color = "black", hjust = 0, vjust = .5)+
labs(title = "A. Differential Gene Expression in HPC - Male",
x="log2 Fold Change",
y=bquote(~-Log[10]~italic(eFDR)))+
theme_bw() +
annotate(geom="text", x=1, y=3, label=paste0(" ", "\n", "Lower in OPFR"),
color="black", size = 5)+
annotate(geom="text", x=-1, y=3, label=paste0(" ", "\n", "Higher in OPFR"),
color="black", size = 5)+
scale_x_continuous(limits = c(-1.5,1.5),breaks = c(-1.5,-1,-.5,0,.5,1,1.5))+
theme(axis.text.x = element_text(vjust = 1,size = 20),
# axis.ticks = element_blank(),
axis.text.y = element_text(hjust = 0.5,size = 20),
axis.text = element_text(color="#3C3C3C",size = 20),
axis.title = element_text(size = 20),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none",
strip.background = element_blank(),
strip.text.x = element_text(size = 20),
text = element_text(size = 20)
)
vp_Elevel_M #875 x 550
top25sigdiff_genes_Elevel_M <- y1a %>%
filter(logFC >= 0.2 | logFC <= -0.2) %>%
arrange(P.Value) %>%
select(symbol, logFC, P.Value, chr, description) %>%
head(25)
# volcano plot Elevel Low
library(limma)
library(edgeR)
library(Mus.musculus)
organism = 'org.Mm.eg.db'
library(organism, character.only = TRUE)
library(biomaRt)
library(AnnotationDbi)
library(pheatmap)
library(annotables)
library(clusterProfiler)
library(enrichplot)
library(organism, character.only = TRUE)
library(DOSE)
library(EnhancedVolcano)
library(tidyverse)
grcm38 # mouse genes
my_logFC_threshold = 0.2
y1a <- readRDS("results/Elevel_low_limma_results.RDS")
dc <- y1a %>% mutate(contrast = "Oil vs. OPFR") %>% mutate(log10 = -log10(P.Value))
dc$diffexpressed <- "NO"
# if log2Foldchange > 0.6 and pvalue < 0.05, set as "UP"
dc$diffexpressed[dc$logFC > 0.2 & dc$P.Value < 0.05] <- "UP"
# if log2Foldchange < -0.6 and pvalue < 0.05, set as "DOWN"
dc$diffexpressed[dc$logFC < -0.2 & dc$P.Value < 0.05] <- "DOWN"
dcx <- dc %>% filter(.,logFC >= .4)%>% filter(P.Value < 0.05)
dcxx <- dc %>% filter(.,logFC <= -.45) %>% filter(P.Value < 0.05)
dcxxx<- dc %>%
filter(logFC >= 0.2 | logFC <= -0.2) %>%
arrange(P.Value) %>%
slice_head(n = 10)
dc$log10 <- ifelse(dc$log10 == Inf, 4,dc$log10)
vp_Elevel_low <- ggplot(data = dc,
aes(x = logFC,
y = log10,
colour=diffexpressed)) +
geom_point(alpha=0.25, size=3.5) +
scale_color_manual(values=c("hotpink", "grey","skyblue"))+
xlim(c(-1.5, 1.5)) +
ylim(0,4)+
geom_vline(xintercept=c(-.2,.2),lty=4,col="black",lwd=0.8) +
#  geom_vline(xintercept=c(-1,1),lty=4,col="black",lwd=0.8) +
geom_hline(yintercept = 1.301,lty=4,col="black",lwd=0.8) +
#  geom_text_repel(data = dcx, aes(x = logFC, y = -log10(P.Value),label = symbol), color = "black",vjust =1, hjust =.45)+
#  geom_text_repel(data = dcxx, aes(x = logFC, y = -log10(P.Value),label = symbol), color = "black", hjust = 1, vjust = -.55)+
geom_text_repel(data = dcxxx, aes(x = logFC, y = -log10(P.Value),label = symbol), color = "black", hjust = 1, vjust = -.3)+
labs(title = "B. Differential Gene Expression in HPC - E Level: Low",
x="log2 Fold Change",
y=bquote(~-Log[10]~italic(eFDR)))+
theme_bw() +
annotate(geom="text", x=1, y=2.75, label=paste0(" ", "\n", "Lower in OPFR"),
color="black", size = 5)+
annotate(geom="text", x=-1, y=2.75, label=paste0(" ", "\n", "Higher in OPFR"),
color="black", size = 5)+
scale_x_continuous(limits = c(-1.5,1.5),breaks = c(-1.5,-1,-.5,0,.5,1,1.5))+
theme(axis.text.x = element_text(vjust = 1,size = 20),
# axis.ticks = element_blank(),
axis.text.y = element_text(hjust = 0.5,size = 20),
axis.text = element_text(color="#3C3C3C",size = 20),
axis.title = element_text(size = 20),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none",
strip.background = element_blank(),
strip.text.x = element_text(size = 20),
text = element_text(size = 20)
)
vp_Elevel_low #875 x 550
top25sigdiff_genes_Elevel_low <- y1a %>%
filter(logFC >= 0.2 | logFC <= -0.2) %>%
arrange(P.Value) %>%
select(symbol, logFC, P.Value, chr, description) %>%
head(25)
# volcano plot Elevel high
library(limma)
library(edgeR)
library(Mus.musculus)
organism = 'org.Mm.eg.db'
library(organism, character.only = TRUE)
library(biomaRt)
library(AnnotationDbi)
library(pheatmap)
library(annotables)
library(clusterProfiler)
library(enrichplot)
library(organism, character.only = TRUE)
library(DOSE)
library(EnhancedVolcano)
library(tidyverse)
grcm38 # mouse genes
my_logFC_threshold = 0.2
y1a <- readRDS("results/Elevel_high_limma_results.RDS")
dc <- y1a %>% mutate(contrast = "Oil vs. OPFR") %>% mutate(log10 = -log10(P.Value))
dc$diffexpressed <- "NO"
# if log2Foldchange > 0.6 and pvalue < 0.05, set as "UP"
dc$diffexpressed[dc$logFC > 0.2 & dc$P.Value < 0.05] <- "UP"
# if log2Foldchange < -0.6 and pvalue < 0.05, set as "DOWN"
dc$diffexpressed[dc$logFC < -0.2 & dc$P.Value < 0.05] <- "DOWN"
dcx <- dc %>% filter(.,logFC >= .4)%>% filter(P.Value < 0.05)
dcxx <- dc %>% filter(.,logFC <= -.45) %>% filter(P.Value < 0.05)
dcxxx<- dc %>%
filter(logFC >= 0.2 | logFC <= -0.2) %>%
arrange(P.Value) %>%
slice_head(n = 10)
dc$log10 <- ifelse(dc$log10 == Inf, 4,dc$log10)
vp_Elevel_high <- ggplot(data = dc,
aes(x = logFC,
y = log10,
colour=diffexpressed)) +
geom_point(alpha=0.25, size=3.5) +
scale_color_manual(values=c("hotpink", "grey","skyblue"))+
xlim(c(-1.5, 1.5)) +
ylim(0,4)+
geom_vline(xintercept=c(-.2,.2),lty=4,col="black",lwd=0.8) +
#  geom_vline(xintercept=c(-1,1),lty=4,col="black",lwd=0.8) +
geom_hline(yintercept = 1.301,lty=4,col="black",lwd=0.8) +
#  geom_text_repel(data = dcx, aes(x = logFC, y = -log10(P.Value),label = symbol), color = "black",vjust =1, hjust =.45)+
#  geom_text_repel(data = dcxx, aes(x = logFC, y = -log10(P.Value),label = symbol), color = "black", hjust = 1, vjust = -.55)+
geom_text_repel(data = dcxxx, aes(x = logFC, y = -log10(P.Value),label = symbol), color = "black", hjust = 0, vjust = .5, max.overlaps = 7)+
labs(title = "A. Differential Gene Expression in HPC - E Level: High",
x="log2 Fold Change",
y=bquote(~-Log[10]~italic(eFDR)))+
theme_bw() +
annotate(geom="text", x=1, y=2.75, label=paste0(" ", "\n", "Lower in OPFR"),
color="black", size = 5)+
annotate(geom="text", x=-1, y=2.75, label=paste0(" ", "\n", "Higher in OPFR"),
color="black", size = 5)+
scale_x_continuous(limits = c(-1.5,1.5),breaks = c(-1.5,-1,-.5,0,.5,1,1.5))+
theme(axis.text.x = element_text(vjust = 1,size = 20),
# axis.ticks = element_blank(),
axis.text.y = element_text(hjust = 0.5,size = 20),
axis.text = element_text(color="#3C3C3C",size = 20),
axis.title = element_text(size = 20),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none",
strip.background = element_blank(),
strip.text.x = element_text(size = 20),
text = element_text(size = 20)
)
vp_Elevel_high #875 x 550
top25sigdiff_genes_Elevel_high <- y1a %>%
filter(logFC >= 0.2 | logFC <= -0.2) %>%
arrange(P.Value) %>%
select(symbol, logFC, P.Value, chr, description) %>%
head(25)
vp_Elevel_high <- ggplot(data = dc,
aes(x = logFC,
y = log10,
colour=diffexpressed)) +
geom_point(alpha=0.25, size=3.5) +
scale_color_manual(values=c("hotpink", "grey","skyblue"))+
xlim(c(-1.5, 1.5)) +
ylim(0,4)+
geom_vline(xintercept=c(-.2,.2),lty=4,col="black",lwd=0.8) +
#  geom_vline(xintercept=c(-1,1),lty=4,col="black",lwd=0.8) +
geom_hline(yintercept = 1.301,lty=4,col="black",lwd=0.8) +
#  geom_text_repel(data = dcx, aes(x = logFC, y = -log10(P.Value),label = symbol), color = "black",vjust =1, hjust =.45)+
#  geom_text_repel(data = dcxx, aes(x = logFC, y = -log10(P.Value),label = symbol), color = "black", hjust = 1, vjust = -.55)+
geom_text_repel(data = dcxxx, aes(x = logFC, y = -log10(P.Value),label = symbol), color = "black", hjust = 0, vjust = .5, max.overlaps = 7)+
labs(title = "C. Differential Gene Expression in HPC - E Level: High",
x="log2 Fold Change",
y=bquote(~-Log[10]~italic(eFDR)))+
theme_bw() +
annotate(geom="text", x=1, y=2.75, label=paste0(" ", "\n", "Lower in OPFR"),
color="black", size = 5)+
annotate(geom="text", x=-1, y=2.75, label=paste0(" ", "\n", "Higher in OPFR"),
color="black", size = 5)+
scale_x_continuous(limits = c(-1.5,1.5),breaks = c(-1.5,-1,-.5,0,.5,1,1.5))+
theme(axis.text.x = element_text(vjust = 1,size = 20),
# axis.ticks = element_blank(),
axis.text.y = element_text(hjust = 0.5,size = 20),
axis.text = element_text(color="#3C3C3C",size = 20),
axis.title = element_text(size = 20),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none",
strip.background = element_blank(),
strip.text.x = element_text(size = 20),
text = element_text(size = 20)
)
vp_Elevel_high #875 x 550
# TREATMENT only WGCNA
# actually, with the way WGCNA works -- this can be for treatment then 6-pairwise right after, right??
# BiocManager::install("")
library(WGCNA)
library(DESeq2)
library(GEOquery)
library(CorLevelPlot)
library(gridExtra)
library(clusterProfiler)
library(enrichplot)
library(biomaRt)
library(AnnotationDbi)
library(annotables)
grcm38 <- grcm38
library(tidyverse)
source("functions/gettop10GO.R")
allowWGCNAThreads()          # allow multi-threading (optional)
data <- read.csv("rawdata/KT_Counts.csv")
phenoData <- read.csv("rawdata/kim rnaseq phenodata.csv")
data[1:10, 1:10]
head(phenoData)
# prepare data
data <- data %>%
gather(key = "samples", value = "counts", -X) %>%
rename(gene = X) %>%
inner_join(., phenoData, by = c("samples" = "id")) %>%
select(1, 3, 2) %>%
spread(key = "samples", value = "counts") %>%
column_to_rownames(var = "gene")
