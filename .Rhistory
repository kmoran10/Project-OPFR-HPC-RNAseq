annotate(geom="text", x=-1, y=2.75, label=paste0(" ", "\n", "Higher in OPFR"),
color="black", size = 5)+
scale_x_continuous(limits = c(-1.5,1.5),breaks = c(-1.5,-1,-.5,0,.5,1,1.5))+
theme(axis.text.x = element_text(vjust = 1,size = 20),
# axis.ticks = element_blank(),
axis.text.y = element_text(hjust = 0.5,size = 20),
axis.text = element_text(color="#3C3C3C",size = 20),
axis.title = element_text(size = 20),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none",
strip.background = element_blank(),
strip.text.x = element_text(size = 20),
text = element_text(size = 20)
)
vp_Elevel_high #875 x 550
vp_Elevel_high <- ggplot(data = dc,
aes(x = logFC,
y = log10,
colour=diffexpressed)) +
geom_point(alpha=0.25, size=3.5) +
scale_color_manual(values=c("hotpink", "grey","skyblue"))+
xlim(c(-1.5, 1.5)) +
ylim(0,4)+
geom_vline(xintercept=c(-.2,.2),lty=4,col="black",lwd=0.8) +
#  geom_vline(xintercept=c(-1,1),lty=4,col="black",lwd=0.8) +
geom_hline(yintercept = 1.301,lty=4,col="black",lwd=0.8) +
#  geom_text_repel(data = dcx, aes(x = logFC, y = -log10(P.Value),label = symbol), color = "black",vjust =1, hjust =.45)+
#  geom_text_repel(data = dcxx, aes(x = logFC, y = -log10(P.Value),label = symbol), color = "black", hjust = 1, vjust = -.55)+
geom_text_repel(data = dcxxx, aes(x = logFC, y = -log10(P.Value),label = symbol), color = "black", hjust = 0, vjust = .5, max.overlaps = 11)+
labs(title = "A. Differential Gene Expression in HPC - E Level: High",
x="log2 Fold Change",
y=bquote(~-Log[10]~italic(eFDR)))+
theme_bw() +
annotate(geom="text", x=1, y=2.75, label=paste0(" ", "\n", "Lower in OPFR"),
color="black", size = 5)+
annotate(geom="text", x=-1, y=2.75, label=paste0(" ", "\n", "Higher in OPFR"),
color="black", size = 5)+
scale_x_continuous(limits = c(-1.5,1.5),breaks = c(-1.5,-1,-.5,0,.5,1,1.5))+
theme(axis.text.x = element_text(vjust = 1,size = 20),
# axis.ticks = element_blank(),
axis.text.y = element_text(hjust = 0.5,size = 20),
axis.text = element_text(color="#3C3C3C",size = 20),
axis.title = element_text(size = 20),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none",
strip.background = element_blank(),
strip.text.x = element_text(size = 20),
text = element_text(size = 20)
)
vp_Elevel_high #875 x 550
vp_Elevel_high <- ggplot(data = dc,
aes(x = logFC,
y = log10,
colour=diffexpressed)) +
geom_point(alpha=0.25, size=3.5) +
scale_color_manual(values=c("hotpink", "grey","skyblue"))+
xlim(c(-1.5, 1.5)) +
ylim(0,4)+
geom_vline(xintercept=c(-.2,.2),lty=4,col="black",lwd=0.8) +
#  geom_vline(xintercept=c(-1,1),lty=4,col="black",lwd=0.8) +
geom_hline(yintercept = 1.301,lty=4,col="black",lwd=0.8) +
#  geom_text_repel(data = dcx, aes(x = logFC, y = -log10(P.Value),label = symbol), color = "black",vjust =1, hjust =.45)+
#  geom_text_repel(data = dcxx, aes(x = logFC, y = -log10(P.Value),label = symbol), color = "black", hjust = 1, vjust = -.55)+
geom_text_repel(data = dcxxx, aes(x = logFC, y = -log10(P.Value),label = symbol), color = "black", hjust = 0, vjust = .5, max.overlaps = 9)+
labs(title = "A. Differential Gene Expression in HPC - E Level: High",
x="log2 Fold Change",
y=bquote(~-Log[10]~italic(eFDR)))+
theme_bw() +
annotate(geom="text", x=1, y=2.75, label=paste0(" ", "\n", "Lower in OPFR"),
color="black", size = 5)+
annotate(geom="text", x=-1, y=2.75, label=paste0(" ", "\n", "Higher in OPFR"),
color="black", size = 5)+
scale_x_continuous(limits = c(-1.5,1.5),breaks = c(-1.5,-1,-.5,0,.5,1,1.5))+
theme(axis.text.x = element_text(vjust = 1,size = 20),
# axis.ticks = element_blank(),
axis.text.y = element_text(hjust = 0.5,size = 20),
axis.text = element_text(color="#3C3C3C",size = 20),
axis.title = element_text(size = 20),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none",
strip.background = element_blank(),
strip.text.x = element_text(size = 20),
text = element_text(size = 20)
)
vp_Elevel_high #875 x 550
vp_Elevel_high <- ggplot(data = dc,
aes(x = logFC,
y = log10,
colour=diffexpressed)) +
geom_point(alpha=0.25, size=3.5) +
scale_color_manual(values=c("hotpink", "grey","skyblue"))+
xlim(c(-1.5, 1.5)) +
ylim(0,4)+
geom_vline(xintercept=c(-.2,.2),lty=4,col="black",lwd=0.8) +
#  geom_vline(xintercept=c(-1,1),lty=4,col="black",lwd=0.8) +
geom_hline(yintercept = 1.301,lty=4,col="black",lwd=0.8) +
#  geom_text_repel(data = dcx, aes(x = logFC, y = -log10(P.Value),label = symbol), color = "black",vjust =1, hjust =.45)+
#  geom_text_repel(data = dcxx, aes(x = logFC, y = -log10(P.Value),label = symbol), color = "black", hjust = 1, vjust = -.55)+
geom_text_repel(data = dcxxx, aes(x = logFC, y = -log10(P.Value),label = symbol), color = "black", hjust = 0, vjust = .5, max.overlaps = 8)+
labs(title = "A. Differential Gene Expression in HPC - E Level: High",
x="log2 Fold Change",
y=bquote(~-Log[10]~italic(eFDR)))+
theme_bw() +
annotate(geom="text", x=1, y=2.75, label=paste0(" ", "\n", "Lower in OPFR"),
color="black", size = 5)+
annotate(geom="text", x=-1, y=2.75, label=paste0(" ", "\n", "Higher in OPFR"),
color="black", size = 5)+
scale_x_continuous(limits = c(-1.5,1.5),breaks = c(-1.5,-1,-.5,0,.5,1,1.5))+
theme(axis.text.x = element_text(vjust = 1,size = 20),
# axis.ticks = element_blank(),
axis.text.y = element_text(hjust = 0.5,size = 20),
axis.text = element_text(color="#3C3C3C",size = 20),
axis.title = element_text(size = 20),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none",
strip.background = element_blank(),
strip.text.x = element_text(size = 20),
text = element_text(size = 20)
)
vp_Elevel_high #875 x 550
vp_Elevel_high <- ggplot(data = dc,
aes(x = logFC,
y = log10,
colour=diffexpressed)) +
geom_point(alpha=0.25, size=3.5) +
scale_color_manual(values=c("hotpink", "grey","skyblue"))+
xlim(c(-1.5, 1.5)) +
ylim(0,4)+
geom_vline(xintercept=c(-.2,.2),lty=4,col="black",lwd=0.8) +
#  geom_vline(xintercept=c(-1,1),lty=4,col="black",lwd=0.8) +
geom_hline(yintercept = 1.301,lty=4,col="black",lwd=0.8) +
#  geom_text_repel(data = dcx, aes(x = logFC, y = -log10(P.Value),label = symbol), color = "black",vjust =1, hjust =.45)+
#  geom_text_repel(data = dcxx, aes(x = logFC, y = -log10(P.Value),label = symbol), color = "black", hjust = 1, vjust = -.55)+
geom_text_repel(data = dcxxx, aes(x = logFC, y = -log10(P.Value),label = symbol), color = "black", hjust = 0, vjust = .5, max.overlaps = 7)+
labs(title = "A. Differential Gene Expression in HPC - E Level: High",
x="log2 Fold Change",
y=bquote(~-Log[10]~italic(eFDR)))+
theme_bw() +
annotate(geom="text", x=1, y=2.75, label=paste0(" ", "\n", "Lower in OPFR"),
color="black", size = 5)+
annotate(geom="text", x=-1, y=2.75, label=paste0(" ", "\n", "Higher in OPFR"),
color="black", size = 5)+
scale_x_continuous(limits = c(-1.5,1.5),breaks = c(-1.5,-1,-.5,0,.5,1,1.5))+
theme(axis.text.x = element_text(vjust = 1,size = 20),
# axis.ticks = element_blank(),
axis.text.y = element_text(hjust = 0.5,size = 20),
axis.text = element_text(color="#3C3C3C",size = 20),
axis.title = element_text(size = 20),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none",
strip.background = element_blank(),
strip.text.x = element_text(size = 20),
text = element_text(size = 20)
)
vp_Elevel_high #875 x 550
# volcano plot Males
library(limma)
library(edgeR)
library(Mus.musculus)
organism = 'org.Mm.eg.db'
library(organism, character.only = TRUE)
library(biomaRt)
library(AnnotationDbi)
library(pheatmap)
library(annotables)
library(clusterProfiler)
library(enrichplot)
library(organism, character.only = TRUE)
library(DOSE)
library(EnhancedVolcano)
library(tidyverse)
grcm38 # mouse genes
my_logFC_threshold = 0.2
y1a <- readRDS("results/Elevel_M_limma_results.RDS")
dc <- y1a %>% mutate(contrast = "Oil vs. OPFR") %>% mutate(log10 = -log10(P.Value))
dc$diffexpressed <- "NO"
# if log2Foldchange > 0.6 and pvalue < 0.05, set as "UP"
dc$diffexpressed[dc$logFC > 0.2 & dc$P.Value < 0.05] <- "UP"
# if log2Foldchange < -0.6 and pvalue < 0.05, set as "DOWN"
dc$diffexpressed[dc$logFC < -0.2 & dc$P.Value < 0.05] <- "DOWN"
dcx <- dc %>% filter(.,logFC >= .4)%>% filter(P.Value < 0.05)
dcxx <- dc %>% filter(.,logFC <= -.45) %>% filter(P.Value < 0.05)
dcxxx<- dc %>%
filter(logFC >= 0.2 | logFC <= -0.2) %>%
arrange(P.Value) %>%
slice_head(n = 10)
dc$log10 <- ifelse(dc$log10 == Inf, 4,dc$log10)
vp_Elevel_M <- ggplot(data = dc,
aes(x = logFC,
y = log10,
colour=diffexpressed)) +
geom_point(alpha=0.25, size=3.5) +
scale_color_manual(values=c("hotpink", "grey","skyblue"))+
xlim(c(-1.5, 1.5)) +
ylim(0,4)+
geom_vline(xintercept=c(-.2,.2),lty=4,col="black",lwd=0.8) +
#  geom_vline(xintercept=c(-1,1),lty=4,col="black",lwd=0.8) +
geom_hline(yintercept = 1.301,lty=4,col="black",lwd=0.8) +
#  geom_text_repel(data = dcx, aes(x = logFC, y = -log10(P.Value),label = symbol), color = "black",vjust =1, hjust =.45)+
#  geom_text_repel(data = dcxx, aes(x = logFC, y = -log10(P.Value),label = symbol), color = "black", hjust = 1, vjust = -.55)+
geom_text_repel(data = dcxxx, aes(x = logFC, y = -log10(P.Value),label = symbol), color = "black", hjust = 0, vjust = .5)+
labs(title = "A. Differential Gene Expression in HPC - Male",
x="log2 Fold Change",
y=bquote(~-Log[10]~italic(eFDR)))+
theme_bw() +
annotate(geom="text", x=1, y=2.75, label=paste0(" ", "\n", "Lower in OPFR"),
color="black", size = 5)+
annotate(geom="text", x=-1, y=2.75, label=paste0(" ", "\n", "Higher in OPFR"),
color="black", size = 5)+
scale_x_continuous(limits = c(-1.5,1.5),breaks = c(-1.5,-1,-.5,0,.5,1,1.5))+
theme(axis.text.x = element_text(vjust = 1,size = 20),
# axis.ticks = element_blank(),
axis.text.y = element_text(hjust = 0.5,size = 20),
axis.text = element_text(color="#3C3C3C",size = 20),
axis.title = element_text(size = 20),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none",
strip.background = element_blank(),
strip.text.x = element_text(size = 20),
text = element_text(size = 20)
)
vp_Elevel_M #875 x 550
top25sigdiff_genes_Elevel_M <- y1a %>%
filter(logFC >= 0.2 | logFC <= -0.2) %>%
arrange(P.Value) %>%
select(symbol, logFC, P.Value, chr, description) %>%
head(25)
write.csv(top25sigdiff_genes_Elevel_M,"results/results_tables/top25sigdiff_genes_Elevel_M.csv", row.names = F)
View(dcxxx)
View(top25sigdiff_genes_Elevel_M)
View(dc)
vp_Elevel_M <- ggplot(data = dc,
aes(x = logFC,
y = log10,
colour=diffexpressed)) +
geom_point(alpha=0.25, size=3.5) +
scale_color_manual(values=c("hotpink", "grey","skyblue"))+
xlim(c(-1.5, 1.5)) +
ylim(0,4)+
geom_vline(xintercept=c(-.2,.2),lty=4,col="black",lwd=0.8) +
#  geom_vline(xintercept=c(-1,1),lty=4,col="black",lwd=0.8) +
geom_hline(yintercept = 1.301,lty=4,col="black",lwd=0.8) +
#  geom_text_repel(data = dcx, aes(x = logFC, y = -log10(P.Value),label = symbol), color = "black",vjust =1, hjust =.45)+
#  geom_text_repel(data = dcxx, aes(x = logFC, y = -log10(P.Value),label = symbol), color = "black", hjust = 1, vjust = -.55)+
geom_text_repel(data = dcxxx, aes(x = logFC, y = -log10(P.Value),label = symbol), color = "black", hjust = 0, vjust = .5)+
labs(title = "A. Differential Gene Expression in HPC - Male",
x="log2 Fold Change",
y=bquote(~-Log[10]~italic(eFDR)))+
theme_bw() +
annotate(geom="text", x=1, y=3, label=paste0(" ", "\n", "Lower in OPFR"),
color="black", size = 5)+
annotate(geom="text", x=-1, y=3, label=paste0(" ", "\n", "Higher in OPFR"),
color="black", size = 5)+
scale_x_continuous(limits = c(-1.5,1.5),breaks = c(-1.5,-1,-.5,0,.5,1,1.5))+
theme(axis.text.x = element_text(vjust = 1,size = 20),
# axis.ticks = element_blank(),
axis.text.y = element_text(hjust = 0.5,size = 20),
axis.text = element_text(color="#3C3C3C",size = 20),
axis.title = element_text(size = 20),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none",
strip.background = element_blank(),
strip.text.x = element_text(size = 20),
text = element_text(size = 20)
)
vp_Elevel_M #875 x 550
#  Oil Comparisons -- cutoff ranges tables
library(limma)
library(edgeR)
library(Mus.musculus)
organism = 'org.Mm.eg.db'
library(organism, character.only = TRUE)
library(biomaRt)
library(AnnotationDbi)
library(pheatmap)
library(annotables)
library(clusterProfiler)
library(enrichplot)
library(organism, character.only = TRUE)
library(DOSE)
library(EnhancedVolcano)
library(tidyverse)
grcm38 # mouse genes
my_logFC_threshold = 0.2
y1a <- readRDS("results/Elevel_M_limma_results.RDS")
y1a <- readRDS("results/Oil_limma_results.RDS")
View(y1a)
View(y1a)
y1a$M_v_low %>% filter(.,logFC >= .2)%>% filter(P.Value < 0.05) %>% summarise(n = nrow(.)) #309
y1a$M_v_low %>% filter(between(logFC, .2, .75))%>% filter(P.Value < 0.05) %>% summarise(n = nrow(.)) # 276
y1a$M_v_low %>% filter(between(logFC, .75, 1.5))%>% filter(P.Value < 0.05) %>% summarise(n = nrow(.)) #36
y1a$M_v_low %>% filter(between(logFC, 1.5, 3))%>% filter(P.Value < 0.05) %>% summarise(n = nrow(.)) #6
y1a$M_v_low %>% filter(.,logFC <= -.2) %>% filter(P.Value < 0.05)%>% summarise(n = nrow(.)) # 322
y1a$M_v_low %>% filter(between(logFC, -0.75, -0.2)) %>% filter(P.Value < 0.05)%>% summarise(n = nrow(.)) # 248
y1a$M_v_low %>% filter(between(logFC, -1.5, -0.75)) %>% filter(P.Value < 0.05)%>% summarise(n = nrow(.))# 62
y1a$M_v_low %>% filter(between(logFC, -3, -1.5)) %>% filter(P.Value < 0.05)%>% summarise(n = nrow(.)) # 12
y1a$M_v_high %>% filter(.,logFC >= .2)%>% filter(P.Value < 0.05) %>% summarise(n = nrow(.)) # 243
y1a$M_v_high %>% filter(between(logFC, .2, .75))%>% filter(P.Value < 0.05) %>% summarise(n = nrow(.)) # 225
y1a$M_v_high %>% filter(between(logFC, .75, 1.5))%>% filter(P.Value < 0.05) %>% summarise(n = nrow(.)) # 14
y1a$M_v_high %>% filter(between(logFC, 1.5, 3))%>% filter(P.Value < 0.05) %>% summarise(n = nrow(.)) # 0
y1a$M_v_high %>% filter(.,logFC <= -.2) %>% filter(P.Value < 0.05)%>% summarise(n = nrow(.)) #  158
y1a$M_v_high %>% filter(between(logFC, -0.75, -0.2)) %>% filter(P.Value < 0.05)%>% summarise(n = nrow(.)) # 149
y1a$M_v_high %>% filter(between(logFC, -1.5, -0.75)) %>% filter(P.Value < 0.05)%>% summarise(n = nrow(.))# 7
y1a$low_v_high %>% filter(.,logFC >= .2)%>% filter(P.Value < 0.05) %>% summarise(n = nrow(.)) # 243
y1a$low_v_high %>% filter(between(logFC, .2, .75))%>% filter(P.Value < 0.05) %>% summarise(n = nrow(.)) # 225
y1a$low_v_high %>% filter(between(logFC, .75, 1.5))%>% filter(P.Value < 0.05) %>% summarise(n = nrow(.)) # 14
y1a$low_v_high %>% filter(between(logFC, 1.5, 3))%>% filter(P.Value < 0.05) %>% summarise(n = nrow(.)) # 0
y1a$low_v_high %>% filter(.,logFC <= -.2) %>% filter(P.Value < 0.05)%>% summarise(n = nrow(.)) #  158
y1a$low_v_high %>% filter(.,logFC <= -.2) %>% filter(P.Value < 0.05)%>% summarise(n = nrow(.)) #  158
y1a$low_v_high %>% filter(between(logFC, -0.75, -0.2)) %>% filter(P.Value < 0.05)%>% summarise(n = nrow(.)) # 149
y1a$low_v_high %>% filter(between(logFC, -1.5, -0.75)) %>% filter(P.Value < 0.05)%>% summarise(n = nrow(.))# 7
y1a$low_v_high %>% filter(between(logFC, -3, -1.5)) %>% filter(P.Value < 0.05)%>% summarise(n = nrow(.)) # 1
y1a <- readRDS("results/OPFR_limma_results.RDS")
y1a$M_v_low %>% filter(.,logFC >= .2)%>% filter(P.Value < 0.05) %>% summarise(n = nrow(.)) # 243
y1a$M_v_low %>% filter(between(logFC, .2, .75))%>% filter(P.Value < 0.05) %>% summarise(n = nrow(.)) # 225
y1a$M_v_low %>% filter(between(logFC, .75, 1.5))%>% filter(P.Value < 0.05) %>% summarise(n = nrow(.)) # 14
y1a$M_v_low %>% filter(between(logFC, 1.5, 3))%>% filter(P.Value < 0.05) %>% summarise(n = nrow(.)) # 0
y1a$M_v_low %>% filter(.,logFC <= -.2) %>% filter(P.Value < 0.05)%>% summarise(n = nrow(.)) #  158
y1a$M_v_low %>% filter(between(logFC, -0.75, -0.2)) %>% filter(P.Value < 0.05)%>% summarise(n = nrow(.)) # 149
y1a$M_v_low %>% filter(between(logFC, -1.5, -0.75)) %>% filter(P.Value < 0.05)%>% summarise(n = nrow(.))# 7
y1a$M_v_high %>% filter(.,logFC >= .2)%>% filter(P.Value < 0.05) %>% summarise(n = nrow(.)) # 127
y1a$M_v_high %>% filter(between(logFC, .2, .75))%>% filter(P.Value < 0.05) %>% summarise(n = nrow(.)) # 122
y1a$M_v_high %>% filter(between(logFC, .75, 1.5))%>% filter(P.Value < 0.05) %>% summarise(n = nrow(.)) # 1
y1a$M_v_high %>% filter(between(logFC, 1.5, 3))%>% filter(P.Value < 0.05) %>% summarise(n = nrow(.)) # 0
y1a$M_v_high %>% filter(.,logFC <= -.2) %>% filter(P.Value < 0.05)%>% summarise(n = nrow(.)) #  118
y1a$M_v_high %>% filter(between(logFC, -0.75, -0.2)) %>% filter(P.Value < 0.05)%>% summarise(n = nrow(.)) # 117
y1a$M_v_high %>% filter(between(logFC, -1.5, -0.75)) %>% filter(P.Value < 0.05)%>% summarise(n = nrow(.))# 0
y1a$M_v_high %>% filter(between(logFC, -3, -1.5)) %>% filter(P.Value < 0.05)%>% summarise(n = nrow(.)) # 0
y1a$low_v_high %>% filter(.,logFC >= .2)%>% filter(P.Value < 0.05) %>% summarise(n = nrow(.)) # 227
y1a$low_v_high %>% filter(between(logFC, .2, .75))%>% filter(P.Value < 0.05) %>% summarise(n = nrow(.)) # 223
y1a$low_v_high %>% filter(between(logFC, .75, 1.5))%>% filter(P.Value < 0.05) %>% summarise(n = nrow(.)) # 4
y1a$low_v_high %>% filter(between(logFC, 1.5, 3))%>% filter(P.Value < 0.05) %>% summarise(n = nrow(.)) # 0
y1a$low_v_high %>% filter(.,logFC <= -.2) %>% filter(P.Value < 0.05)%>% summarise(n = nrow(.)) #  171
y1a$low_v_high %>% filter(between(logFC, -0.75, -0.2)) %>% filter(P.Value < 0.05)%>% summarise(n = nrow(.)) # 167
y1a$low_v_high %>% filter(between(logFC, -1.5, -0.75)) %>% filter(P.Value < 0.05)%>% summarise(n = nrow(.))# 2
#top 10 genes up in sub
y1a$M_v_low %>% filter(P.Value < 0.05) %>% arrange(-logFC) %>% head(., 10)
#top 10 genes down in sub
y1a$M_v_low %>% filter(P.Value < 0.05) %>%  arrange(logFC) %>% head(., 10)
#top 10 genes up in sub
y1a$M_v_low %>% filter(P.Value < 0.05) %>% arrange(-logFC) %>% left_join(grcm38, by = "symbol") %>% head(., 10)
#top 10 genes up in sub
y1a$M_v_low %>% filter(P.Value < 0.05) %>% arrange(-logFC) %>% left_join(grcm38, by = "symbol") %>% select(symbol,logFC,P.Value,chr,biotype,description) %>%  head(., 10)
#top 10 genes down in M_v_low
y1a$M_v_low %>% filter(P.Value < 0.05) %>% arrange(logFC) %>% left_join(grcm38, by = "symbol") %>% select(symbol,logFC,P.Value,chr,biotype,description) %>%  head(., 10)
#top 10 genes up in low_v_high
y1a$low_v_high %>% filter(P.Value < 0.05) %>% arrange(-logFC) %>% left_join(grcm38, by = "symbol") %>% select(symbol,logFC,P.Value,chr,biotype,description) %>%  head(., 10)
#top 10 genes down in low_v_high
y1a$low_v_high %>% filter(P.Value < 0.05) %>% arrange(logFC) %>% left_join(grcm38, by = "symbol") %>% select(symbol,logFC,P.Value,chr,biotype,description) %>%  head(., 10)
# GO analysis
library(limma)
library(edgeR)
library(Mus.musculus)
organism = 'org.Mm.eg.db'
library(organism, character.only = TRUE)
library(biomaRt)
library(AnnotationDbi)
library(pheatmap)
library(annotables)
library(clusterProfiler)
library(enrichplot)
library(DOSE)
library(tidyverse)
grcm38 # mouse genes
source("functions/gettop10GO.R")
my_logFC_threshold = 0.2
males <- readRDS("results/Elevel_M_limma_results.RDS")
gettop10GO(males, my_showCategory) %>%
mutate(comparison = "Oil - OPFR") -> top10_GOterms_M
View(top10_GOterms_M)
write.csv(top10_GOterms_M,"results/results_tables/top10_GOterms_M.csv", row.names = F)
low <- readRDS("results/Elevel_low_limma_results.RDS")
gettop10GO(low, my_showCategory) %>%
mutate(comparison = "Oil - OPFR") -> top10_GOterms_low
View(top10_GOterms_low)
write.csv(top10_GOterms_low,"results/results_tables/top10_GOterms_low.csv", row.names = F)
high <- readRDS("results/Elevel_high_limma_results.RDS")
gettop10GO(high, my_showCategory) %>%
mutate(comparison = "Oil - OPFR") -> top10_GOterms_high
write.csv(top10_GOterms_high,"results/results_tables/top10_GOterms_high.csv", row.names = F)
install.packages("VennDiagram")
install.packages("UpSetR")
library(tidyverse)
males <- readRDS("results/Elevel_M_limma_results.RDS")
low <- readRDS("results/Elevel_low_limma_results.RDS")
high <- readRDS("results/Elevel_high_limma_results.RDS")
View(males)
View(low)
View(high)
males_sigs <- males %>%
filter(logFC >= .2 | logFC <= -.2) %>%
filter(P.Value < 0.05) %>%
arrange(desc(abs(logFC))) %>%
select(symbol, logFC, P.Value, description) %>%
mutate(direction = if_else(logFC > 0, "Down", "Up"))
low_sigs <- low %>%
filter(logFC >= .2 | logFC <= -.2) %>%
filter(P.Value < 0.05) %>%
arrange(desc(abs(logFC))) %>%
select(symbol, logFC, P.Value, description) %>%
mutate(direction = if_else(logFC > 0, "Down", "Up"))
high_sigs <- high %>%
filter(logFC >= .2 | logFC <= -.2) %>%
filter(P.Value < 0.05) %>%
arrange(desc(abs(logFC))) %>%
select(symbol, logFC, P.Value, description) %>%
mutate(direction = if_else(logFC > 0, "Down", "Up"))
combined <- bind_rows(
males_sigs %>% mutate(source = "Males"),
low_sigs %>% mutate(source = "Low E"),
high_sigs %>% mutate(source = "High E")
)
overlap_table <- combined %>%
group_by(symbol, direction) %>%
summarize(
count = n_distinct(source),
sources = paste(unique(source), collapse = ", "),
description = paste(unique(description), collapse = "; "),
.groups = "drop"
) %>%
filter(count > 1) %>% # Remove cases with no overlap
arrange(desc(count)) %>%
arrange(desc(direction)) %>%
select(symbol, direction, sources, description)
View(overlap_table)
write.csv(overlap_table,"results/results_tables/overlap_table.csv", row.names = F)
conflict_table <- combined %>%
group_by(symbol) %>%
filter(n_distinct(direction) > 1) %>% # Keep symbols with conflicting directions
summarize(
sources_up = paste(source[direction == "Up"], collapse = ", "),
sources_down = paste(source[direction == "Down"], collapse = ", "),
description = paste(unique(description), collapse = "; "),
.groups = "drop"
) %>%
filter(sources_up != "" & sources_down != "") %>% # Ensure there's at least one source for both "Up" and "Down"
arrange(desc(sources_up))
View(conflict_table)
write.csv(conflict_table,"results/results_tables/conflict_table.csv", row.names = F)
View(males_sigs)
Elevel_high_limma_results1 <- readRDS("results/Elevel_high_limma_results.RDS")
Elevel_high_limma_results1 %>%
filter(., P.Value<0.05) %>%
filter(., P.Value != 0) %>%
summarise(.,Up = sum(logFC>0.2),
Down = sum(logFC<0.2)) %>%
mutate(.,Total = Up + Down)
Elevel_high_limma_results1 %>%
filter(., P.Value<0.05) %>%
#  filter(., P.Value != 0) %>%
summarise(.,Up = sum(logFC>0.2),
Down = sum(logFC<0.2)) %>%
mutate(.,Total = Up + Down)
Elevel_high_limma_results1 %>%
filter(., P.Value<0.05) %>%
#  filter(., P.Value != 0) %>%
summarise(.,Up = sum(logFC>0.2),
Down = sum(logFC<-0.2)) %>%
mutate(.,Total = Up + Down)
Elevel_high_limma_results1 %>%
filter(., P.Value<0.05) %>%
#  filter(., P.Value != 0) %>%
summarise(.,Up = sum(logFC>-0.2),
Down = sum(logFC<0.2)) %>%
mutate(.,Total = Up + Down)
table(males_sigs$direction)
table(low_sigs$direction)
table(high_sigs$direction)
# TREATMENT only WGCNA
# actually, with the way WGCNA works -- this can be for treatment then 6-pairwise right after, right??
# BiocManager::install("")
library(WGCNA)
library(DESeq2)
library(GEOquery)
library(CorLevelPlot)
library(gridExtra)
library(clusterProfiler)
library(enrichplot)
library(biomaRt)
library(AnnotationDbi)
library(annotables)
grcm38 <- grcm38
library(tidyverse)
source("functions/gettop10GO.R")
allowWGCNAThreads()          # allow multi-threading (optional)
data <- read.csv("rawdata/KT_Counts.csv")
phenoData <- read.csv("rawdata/kim rnaseq phenodata.csv")
data[1:10, 1:10]
head(phenoData)
# prepare data
data <- data %>%
gather(key = "samples", value = "counts", -X) %>%
rename(gene = X) %>%
inner_join(., phenoData, by = c("samples" = "id")) %>%
select(1, 3, 2) %>%
spread(key = "samples", value = "counts") %>%
column_to_rownames(var = "gene")
devtools::install_github("romainfrancois/nothing")
loadedNamespaces()
library(nothing)
loadedNamespaces()
# TREATMENT only WGCNA
# actually, with the way WGCNA works -- this can be for treatment then 6-pairwise right after, right??
# BiocManager::install("")
library(WGCNA)
